# slurm.conf file generated by configurator.html.
# Put this file on all nodes of your cluster.
# See the slurm.conf man page for more information.
#
ControlMachine=node90
ControlAddr=10.6.8.90
#BackupController=k20r4n01
#BackupAddr=10.11.20.62
#
AuthType=auth/munge
#CacheGroups=0
#CheckpointType=checkpoint/none
CryptoType=crypto/munge
#DisableRootJobs=YES
EnforcePartLimits=YES

#Epilog=/opt/gridview/slurm/etc/sothisai/slurm.epilog
#Prolog=/opt/gridview/slurm/etc/sothisai/slurm.prolog

#EpilogSlurmctld=/opt/gridview/slurm/acct_for_gold/scripts/slurmctld.epilog
#PrologSlurmctld=/opt/gridview/slurm/acct_for_gold/scripts/slurmctld.prolog

#SrunEpilog=
#SrunProlog=

#TaskEpilog=/opt/gridview/slurm/etc/slurm.epilog
#TaskProlog=/opt/gridview/slurm/etc/slurm.prolog

FirstJobId=10000
MaxJobId=536805376
#GresTypes=
GroupUpdateForce=1
GroupUpdateTime=600
#JobCheckpointDir=/opt/gridview/slurm/checkpoint
#JobCredentialPrivateKey=
#JobCredentialPublicCertificate=
#JobFileAppend=0
JobRequeue=1
#JobSubmitPlugins=lua
KillOnBadExit=1
#LaunchType=launch/slurm
#Licenses=foo*4,bar
#MailProg=/bin/mail
MaxArraySize=1500
MaxJobCount=3000000
#MaxStepCount=40000
#MaxTasksPerNode=128
MpiDefault=none
#MpiParams=ports=#-#
#MpiParams=ports=12000-12999
#PluginDir=
#PlugStackConfig=
#ProctrackType=proctrack/pgid
#ProctrackType=proctrack/linuxproc
ProctrackType=proctrack/cgroup

#PreemptType=preempt/qos
#PreemptType=preempt/partition_prio
#PreemptMode=GANG,SUSPEND

#PrologFlags=Alloc
#PrologFlags=Serial
#PrologFlags=NOHOLD
PrologFlags=CONTAIN

#PropagatePrioProcess=0
#PropagateResourceLimits=
#PropagateResourceLimitsExcept=
#RebootProgram=
ReturnToService=2
#SallocDefaultCommand=
#SlurmctldPidFile=/opt/gridview/slurm/run/slurmctld.pid
SlurmctldPidFile=/var/run/slurmctld.pid
SlurmctldPort=6808
#SlurmdPidFile=/opt/gridview/slurm/run/slurmd.pid
SlurmdPidFile=/var/run/slurmd-%n.pid
SlurmdPort=10011
SlurmdSpoolDir=/opt/gridview/slurm/spool_slurmd.%n
SlurmUser=root
#SlurmdUser=root
StateSaveLocation=/opt/gridview/slurm/spool
#StateSaveLocation=/opt/gridview/slurm/spool_local

SwitchType=switch/none

TaskPlugin=task/affinity,task/cgroup
#TaskPlugin=task/affinity
#TaskPlugin=task/cgroup
#TaskPlugin=task/none
#TaskPluginParam=
#TaskPluginParam=sched
#TopologyPlugin=topology/tree
#TopologyPlugin=topology/3d_torus
#TmpFS=/tmp
#TrackWCKey=no
TreeWidth=1
#UnkillableStepProgram=
#UsePAM=0
RoutePlugin=route/default
#MsgAggregationParams=WindowMsgs=50,WindowTime=500
#
#
# TIMERS
BatchStartTimeout=600
#CompleteWait=0
#EpilogMsgTime=2000
#GetEnvTimeout=2
HealthCheckInterval=300
HealthCheckProgram=/usr/sbin/nhc
HealthCheckNodeState=CYCLE
HealthCheckCarryNode = Yes 

TCPTimeout=3

InactiveLimit=0
KillWait=30
MessageTimeout=100
#ResvOverRun=0
MinJobAge=300
#OverTimeLimit=0
SlurmctldTimeout=30
SlurmdTimeout=10
UnkillableStepTimeout=240
#VSizeFactor=0
Waittime=0
#
EioTimeout=300
#
# SCHEDULING
#DefMemPerCPU=30
#MaxMemPerCPU=70
#MaxMemPerCPU=60
#SchedulerRootFilter=1
#SchedulerTimeSlice=30
SchedulerType=sched/backfill
#SchedulerType=sched/builtin
# SchedulerPort=7321
SelectType=select/cons_res
#SelectTypeParameters=CR_Core
SelectTypeParameters=CR_Core_Memory
#SelectTypeParameters=CR_CPU,CR_LLN

#SchedulerParameters=batch_sched_delay=3,defer,sched_min_interval=1000000,sched_interval=60,default_queue_depth=1000,max_sched_time=2,bf_max_job_test=5000,bf_interval=60,bf_max_time=60,bf_min_age_reserve=10,bf_yield_interval=1000000,partition_job_depth=400,bf_max_job_part=3000,bf_min_prio_reserve=100,bf_window=43200,bf_resolution=3600,bf_continue,max_rpc_cnt=500,enable_user_top,kill_invalid_depend,part_repeat_job_template=50,para_sched
#SchedulerParameters=batch_sched_delay=3,defer,sched_min_interval=1000000,sched_interval=60,default_queue_depth=1000,max_sched_time=2,bf_max_job_test=1,bf_interval=3,bf_max_time=2000,bf_min_age_reserve=10,bf_yield_interval=1000,partition_job_depth=400,bf_max_job_part=3000,bf_min_prio_reserve=100,bf_window=43200,bf_resolution=3600,bf_continue,max_rpc_cnt=500,enable_user_top,kill_invalid_depend,part_repeat_job_template=50,para_sched,enable_high_throughput

#SchedulerParameters=batch_sched_delay=3,defer,sched_min_interval=1000000,sched_interval=60,default_queue_depth=1000,max_sched_time=2,bf_max_job_test=1,bf_interval=3,bf_max_time=2000,bf_min_age_reserve=10,bf_yield_interval=1000,partition_job_depth=400,bf_max_job_part=3000,bf_min_prio_reserve=100,bf_window=43200,bf_resolution=3600,bf_continue,max_rpc_cnt=500,enable_user_top,kill_invalid_depend,part_repeat_job_template=50,para_sched,Ignore_NUMA
SchedulerParameters=enable_high_throughput,defer,batch_sched_delay=3,sched_min_interval=1000000,sched_interval=60,default_queue_depth=1000,max_sched_time=2,bf_max_job_test=1,bf_interval=600,bf_max_time=60,bf_min_age_reserve=10,bf_yield_interval=1000000,partition_job_depth=400,bf_max_job_part=1,bf_min_prio_reserve=100,bf_window=43200,bf_resolution=3600,bf_continue,max_rpc_cnt=500,enable_user_top,kill_invalid_depend,part_repeat_job_template=50,para_sched

#SchedulerParameters=batch_sched_delay=3,defer,sched_min_interval=20000000,sched_interval=30,sched_max_job_start=10,bf_interval=10800,para_sched
SlurmdParameters=l3cache_as_socket




#SelectType=select/cons_tres
#SchedulerParameters = bf_licenses,batch_sched_delay=3,defer,sched_min_interval=1000,sched_interval=3,default_queue_depth=10,max_sched_time=3,bf_max_job_test=1000,bf_interval=3,bf_max_time=2000,bf_min_age_reserve=10,bf_yield_interval=1000,partition_job_depth=400,bf_max_job_part=3000,bf_min_prio_reserve=100,bf_window=43200,bf_resolution=3600,bf_continue,max_rpc_cnt=500,enable_user_top,kill_invalid_depend,part_repeat_job_template=50,enable_high_throughput
#SlurmctldParameters=rl_enable,rl_bucket_size=90,rl_refill_rate=6
#SlurmctldParameters=rl_enable,rl_retry_max_period=3600
SlurmctldParameters=node_borrow_interval=4,step_pendlist_dedup,step_timeout_enhance
# JOB PRIORITY
#PriorityFlags=
PriorityType=priority/multifactor
PriorityDecayHalfLife=06:00:00
PriorityCalcPeriod=15
#PriorityFavorSmall=
#PriorityMaxAge=
#PriorityUsageResetPeriod=
#PriorityWeightAge=
PriorityWeightFairshare=1000
#PriorityWeightJobSize=
PriorityWeightPartition=1000
PriorityWeightQOS=1000
#
#AccountingStorageTRES=cpu,mem,gres/dcu,gres/gpu
#AccountingStorageTRES=cpu,mem
#AccountingStorageTRES=cpu,mem
#
# LOGGING AND ACCOUNTING
#AccountingStorageEnforce=0
#AccountingStorageEnforce=associations
#AccountingStorageEnforce=limits
AccountingStorageHost=node90
#AccountingStorageBackupHost=k20r4n00
AccountingStoragePort=10002
AccountingStorageType=accounting_storage/slurmdbd
AccountingStorageUser=root
AccountingStoreFlags=job_comment
#ClusterName=meta2.1
#ClusterName=wjy4autotest
#ClusterName=wjy723
ClusterName=wjy4testsuite
AssocServerSort=NO

JobCompType=jobcomp/filetxt
JobCompLoc=/opt/gridview/slurm/jobcomp/completed
#JobAcctGatherFrequency=task=300,time_window=1
#JobAcctGatherFrequency=task=300,avecpuutil=100
#JobAcctGatherFrequency=task=300,collect_step=3,time_window=1
#JobAcctGatherFrequency=task=300,avecpuutil=100,time_window=1
#JobAcctGatherFrequency=task=100,collect_step=3,avecpuutil=100
#JobAcctGatherFrequency=task=12,avecpuutil=1000,collect_step=3,time_window=1
#JobAcctGatherFrequency=task=30
#JobAcctGatherFrequency=task=300,disable_job_monitor
#JobAcctGatherFrequency=task=300,time_window=1,avecpuutil=100,collect_step=3
#
JobAcctGatherFrequency=task=300,time_window=1,avecpuutil=100,collect_step=3
#JobAcctGatherFrequency=task=300,disable_job_monitor
#AcctGatherProfileType=acct_gather_profile/influxdb
#JobAcctGatherFrequency=task=300,taskext=0
#JobAcctGatherType=jobacct_gather/none
#JobAcctGatherType=jobacct_gather/none
SlurmctldDebug=debug3
SlurmctldLogFile=/opt/gridview/slurm/log/slurmctld.log
SlurmdDebug=7
SlurmdLogFile=/opt/gridview/slurm/log/slurmd_%n.log
#SlurmSchedLogFile=
#SlurmSchedLogLevel=
#
#
# POWER SAVE SUPPORT FOR IDLE NODES (optional)
#SuspendProgram=/opt/gridview/slurm/etc/Suspend.sh
#ResumeProgram=/opt/gridview/slurm/etc/Resume.sh
#DefIdlePerPart=1
#SuspendTimeout=
#ResumeTimeout=
#ResumeRate=
#SuspendExcNodes=
#SuspendExcParts=
#SuspendRate=
#SuspendTime=120
PrivateData=jobs,part_extend
#
###
# Data not supported by DebugFlags
#DebugFlags=NO_CONF_HASH,Agent,Protocol,Backfill,Power,Route,SelectType
DebugFlags=NO_CONF_HASH,Route,Agent

#Priority,Reservation,Steps,Switch,TraceJobs,Triggers
#License,JobContainer,NodeFeatures
#CPU_Bind,Federation,Gang
#
# COMPUTE NODES
include slurm_node.conf
include slurm_partition.conf
#MaxMemPerNode=92160
PlugStackConfig=/opt/gridview/slurm/etc/plugstack.conf


CacheQuery=disable
CacheQueryPort=6820
CacheDupInterval=30
DownNodeToReg=No
Prolog=/opt/gridview/slurm/etc/sothisai/slurm.prolog
PrologEpilogTimeout=10
Epilog=/opt/gridview/slurm/etc/sothisai/slurm.epilog
